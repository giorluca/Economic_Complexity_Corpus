Reconstruction of production networks and other studies in complexity economics: Reconstruction of production networks

Reconstruction of production networksand other studies in Complexity EconomicsLuca MungoChrist Church CollegeUniversity of OxfordA thesis submitted forDoctor of PhilosophyTrinity 2023AbstractRecent research portrays the economy as a complex, adaptive system com-posed of heterogeneous agents interacting with one another and their en-vironment. This thesis contributes to this research effort, focusing on pro-duction networks and financial markets.International supply chains are a remarkable example of complex networks,and their investigation is crucial to understanding our economies. The firstpart of this thesis is devoted to the reconstruction and modelling of thesenetworks. In Chapter 1, we briefly survey the literature on network recon-struction and how it has been applied to the case of production networks.In Chapter 2, we use Machine Learning to reconstruct the production net-work -i.e., to infer which firms are linked by commercial relationships. Us-ing some sensible economic and financial properties as inputs, we showthat our algorithm outperforms some well-known benchmarks, investigatewhich features are important for accurate predictions, and study to whatextent our approach can be used in real-world tasks. In Chapter 3, we fo-cus on firms’ sales time series and show that the production network has avisible impact on their correlation structure. We build on this finding anddevelop a method to reconstruct production networks from firms’ dynam-ics. Chapter 4 outlines an agent-based model designed to study the impactof exogenous shocks on the real production network. The primary agentsof our model are firms connected by trade and credit relationships. Weexplain the model, provide some analytical results and simulations, anddescribe a simple approach to generate weighted production networks thatmatch some aggregate (and observable) properties of global trade.In the second part of the thesis, we pivot our focus away from produc-tion networks and onto financial markets. Chapter 5, provides empiricalevidence for the Market Ecology hypothesis. This hypothesis models fi-nancial markets as ecologies where trading strategies compete to generatereturns. Using a large dataset of U.S. stock prices, funds’ portfolios, andfunds’ trading strategies, we find a correlation between wealth allocationacross such strategies and market volatility, as recently proposed in sim-ple stylized models. In Chapter 6, we analyze the cryptocurrency marketthrough the framework of its investors’ network. Our findings reveal thatthe structure of this network closely reflects the correlation patterns withinthe cryptocurrency market.3AcknowledgementsI would like to thank my supervisors, Doyne Farmer and François Lafond.Doyne, you have been an inexhaustible source of inspiration. Thanks forbeing such a champion of intellectual freedom and courage, and for theempathy and kindness you have always granted me. François, thanks forall the effort you have put into making me a better researcher, thanks fornot letting me get away with less than I could, and thanks for setting adurable example of what doing good research means. I owe you both lots.Thanks Dorothy and the whole admin team at INET and in Maths for help-ing me navigate Oxford’s baroque bureaucracy.Georges Braque described the years he spent developing Analytic Cubismwith Picasso, saying they “were like mountain climbers roped together”. Ihave always been fond of the quote. The last years somehow felt like walk-ing up a mountain, and I had fantastic rope partners during the ascension.Thank you Max for being the best of friends since my first day in Oxford. Iowe you most of the good times I had north of the English Channel.A special shoutout to Lennart and Valentina for the many hours climbingat Brookes; there is a special place in my heart for our Saturday mornings.Thanks José for being an unattainable example, an unintentional mentor,and a great friend. Working with you was lots of fun.Thank you Blas for introducing me to the group and making that terribleshack we shared feel more like a home.Thanks to the whole INET gang for being such a stimulating, smart, andfun crowd; you all really enriched my time at Oxford. A special thanks toMarco Pangallo, who first welcomed me to the group and encouraged meto apply for a PhD.Thanks to my friends! Mino and Ludo, thanks for your daily, unwaveringsupport, you are the bedrock of my life. Alessandro and Ermanno, thanksfor making me eager to catch the flights back home.Very special thanks to my family. Mum and Dad, thanks for having encour-aged me to pursue my passions freely. Thanks for having been adamant inbelieving that all the options were on my table - at some point, you con-vinced me. Fede, thanks for your unfaltering love, and for bearing with mymost obnoxious days. To my grandparents, thanks for the pride you haveshowered me with. You have constantly motivated me forward.Finally, Coco, thank you for having gone with me through all the ups anddowns of the last few years. This thesis would not exist without the unlim-ited patience, contagious glee, and tireless support that you granted me.Meeting you was a blessing.This thesis is dedicated to the memory of my grandfather.5ContentsForeword 1I Production Networks 61 Production Networks reconstruction 91.1 The supply network reconstruction problem . . . . . . . . . . . . . . . . 111.1.1 What data is available? . . . . . . . . . . . . . . . . . . . . . . . . 121.1.2 A taxonomy of supply network reconstruction approaches . . . 141.1.3 Evaluating the reconstructed networks . . . . . . . . . . . . . . . 151.2 Network reconstruction techniques . . . . . . . . . . . . . . . . . . . . . 171.2.1 Link Prediction . . . . . . . . . . . . . . . . . . . . . . . . . . . . 171.2.2 Network inference . . . . . . . . . . . . . . . . . . . . . . . . . . 181.3 Reconstructing the production network topology . . . . . . . . . . . . . 221.3.1 Link prediction . . . . . . . . . . . . . . . . . . . . . . . . . . . . 221.3.1.1 Setting up the problem . . . . . . . . . . . . . . . . . . 221.3.1.2 Predicting new business partners . . . . . . . . . . . . . 241.3.1.3 Can a firm better understand its supply network de-pendencies? . . . . . . . . . . . . . . . . . . . . . . . . . 251.3.1.4 Predicting the supply networks of entire countries whereno network data exist . . . . . . . . . . . . . . . . . . . 271.3.1.5 Leveraging alternative data: news and phone calls . . . 281.3.2 Network Inference . . . . . . . . . . . . . . . . . . . . . . . . . . 291.3.2.1 Matching algorithms . . . . . . . . . . . . . . . . . . . . 291.3.2.2 Maximum-entropy for network inference . . . . . . . . 301.3.2.3 Leveraging the correlation matrix using graph learning 321.4 Inferring the value of transactions . . . . . . . . . . . . . . . . . . . . . . 331.4.1 Matching I-O tables . . . . . . . . . . . . . . . . . . . . . . . . . . 331.4.2 Maximum entropy for weights inference . . . . . . . . . . . . . . 35i1.5 Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 361.5.1 What have we learned? . . . . . . . . . . . . . . . . . . . . . . . . 371.5.2 How can we learn more? . . . . . . . . . . . . . . . . . . . . . . . 381.6 Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 402 Can machine learning help us to reconstruct production networks? 432.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 432.2 Data and methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 442.2.1 Data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 442.2.2 Setup . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 472.3 Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 522.3.1 Prediction performance . . . . . . . . . . . . . . . . . . . . . . . 522.3.2 Benchmarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 532.3.3 Importance of different features . . . . . . . . . . . . . . . . . . . 572.3.4 Unobserved countries . . . . . . . . . . . . . . . . . . . . . . . . . 592.4 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 643 Firms dynamics and production networks reconstruction 673.1 Data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 693.2 Growth time series . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 703.2.1 Removing common shocks . . . . . . . . . . . . . . . . . . . . . . 713.3 Network correlation and random benchmarks . . . . . . . . . . . . . . . 763.3.1 Random benchmarks . . . . . . . . . . . . . . . . . . . . . . . . . 773.3.2 Relationship with network distance . . . . . . . . . . . . . . . . . 783.4 Supply Chain Reconstruction . . . . . . . . . . . . . . . . . . . . . . . . 793.5 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 844 An agent-based model of production networks 874.1 The model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 894.1.1 Overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 894.1.2 Production . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 914.1.3 Payments . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 954.2 Reconstruction of firms’ transactions. . . . . . . . . . . . . . . . . . . . . 974.2.1 Sampling different solutions . . . . . . . . . . . . . . . . . . . . . 984.3 Results and simulations . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1034.4 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105iiII Financial Markets 1085 Testing the Market Ecology Hypothesis 1115.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1115.2 Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1125.3 Data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1135.3.1 Classification and ownership . . . . . . . . . . . . . . . . . . . . 1135.3.2 Market Data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1145.4 Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1175.4.1 Regressions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1175.4.1.1 Granger Causality . . . . . . . . . . . . . . . . . . . . . 1195.5 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1206 Cryptocurrencies co-investment network 1236.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1236.2 Dataset and methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1266.2.1 Data Description . . . . . . . . . . . . . . . . . . . . . . . . . . . 1266.2.2 Methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1276.3 Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1316.3.1 Structure of the cryptocurrency co-investment network . . . . . 1316.3.2 Interplay between the co-investment network structure and re-turns correlations . . . . . . . . . . . . . . . . . . . . . . . . . . . 1336.4 Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136Concluding remarks 138A Appendix to Chapter 1 140A.1 Similarity scores . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 140A.2 Statistical performance metrics . . . . . . . . . . . . . . . . . . . . . . . 140B Appendix to Chapter 2 143B.1 Model details . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143B.2 Undersampling and evaluation of model performance . . . . . . . . . . 143B.3 FactSet Data processing . . . . . . . . . . . . . . . . . . . . . . . . . . . . 145B.4 Exponential-Family Random Graph Models . . . . . . . . . . . . . . . . 148B.5 Categorical Features . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 151B.6 PR-AUCs results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 153iiiC Appendix to Chapter 3 156C.1 Correlation benchmarks . . . . . . . . . . . . . . . . . . . . . . . . . . . 156C.2 Network Reconstruction Algorithm . . . . . . . . . . . . . . . . . . . . . 156C.3 Dataset construction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 160C.4 Other cleaning strategies . . . . . . . . . . . . . . . . . . . . . . . . . . . 160D Appendix to Chapter 4 162D.1 Analytical solution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 162D.1.1 Steady-state analytical solution for a ring of firms . . . . . . . . 162D.1.1.1 Steady State in the Demand-Constrained regime . . . . 163D.1.1.2 Steady state in the Capacity-Constrained regime . . . . 165D.1.1.3 Demand shocks . . . . . . . . . . . . . . . . . . . . . . . 168D.1.1.4 Productivity Shocks . . . . . . . . . . . . . . . . . . . . 169D.1.2 General Solution in the demand-constrained regime . . . . . . . 170D.1.2.1 Computing the Path Coefficients . . . . . . . . . . . . . 172D.2 Data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 176D.2.1 Data sources . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 176D.2.2 Coverage . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 177D.2.3 Model variables and parameters . . . . . . . . . . . . . . . . . . . 178D.2.3.1 Model’s income statement and balance sheet . . . . . . 181E Appendix to Chapter 5 182E.1 Report schedules . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 182E.2 Top regressions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 183E.3 Lipper classes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 183F Appendix to Chapter 6 188F.1 Methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 188F.1.1 Clustering algorithms . . . . . . . . . . . . . . . . . . . . . . . . . 188F.2 Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 189F.3 Clusters analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 190F.4 Crunchbase dataset . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 191F.5 Coinmarketcap cryptocurrency tags . . . . . . . . . . . . . . . . . . . . . 192Bibliography 196ivForewordComplex adaptive systems are composed of several agents interacting with one an-other and their environment [Weaver, 1948, Mitchell, 2009, Holland, 2014, Thurneret al., 2018]. As the system’s dynamics unfolds, these agents influence their worldand react to the consequences of their collective behaviour. Agents’ interactions, evenwhen local and simple, can produce unexpected global outcomes; typically, theseemergent properties of the system can’t be predicted from knowledge of its compo-nents alone [Anderson, 1972]. This definition encompasses a wide range of examples.Ecologies, social networks, the human brain, and the Internet can all be interpretedand studied as complex systems.The global economy is another such example. Consider financial crises. No com-pany, institution, or person in their right state of mind purposely acts to trigger afinancial meltdown, yet financial crises punctuate history. They are the byproduct ofthe economic activity of heterogeneous actors - firms, banks, governments, and or-dinary people - entangled in a complicated network of interactions. This networkis hard to model which is why, despite having a good understanding of what banksdo, we usually cannot forecast financial crises. They are a remarkable emergent phe-nomenon.In economics, the standard approach to studying how aggregate economic out-comes form from agents’ behaviours is known as neoclassical economics. Neoclassicaleconomics models are based on a few assumptions [Arthur, 2021]. Agents are perfectlyrational: they face well-defined problems and always adopt the strategy that will maxi-mize their outcome. They look much like one another so including a few representativeagents in the model (such as one firm, one household, and one bank) is sufficient: allagents of the same type would behave in the same way. They all know every otheragent and understand that they are all perfectly rational. Finally, their expectationsare consistent with the system’s aggregate outcome; the system is in equilibrium andagents have no incentive to change their actions. Occasionally, an exogenous shock1hits the system but agents adapt swiftly and 
the system reaches a new equilibrium.1These assumptions have some merit. When they were first introduced, they greatlysimplified the mathematical analysis of economic questions by condensing the worldinto a small number of readily observable factors. In an era prior to the diffusionof computers, they were a sensible way forward and provided elegant analytical ex-planations for several economic phenomena. Yet, they have proven to be too strictto provide insights into deep economic downturns [Kirman, 1992, Farmer and Foley,2009, Stiglitz, 2018]. Eventually, neoclassical models might prove of little help inaddressing society’s most pressing issues.2Complexity economics, which investigates the economy through complex systems’lenses, offers an alternative [Arthur, 1999, Bouchaud, 2008, Farmer and Foley, 2009,Farmer, 2012, Haldane and Turrell, 2018, Bouchaud, 2021]. Instead of trying to makethe economy fit into the Procrustean boundaries of neoclassical assumptions, com-plexity economics starts with how agents actually behave and focuses on understand-ing the emergent collective behaviour that they generate, either with analytical the-ories or through computer simulations [Farmer and Foley, 2009, Axtell and Farmer,2022]. Thanks to the recent abundance of computational resources, these simulationscan now run at large scale, producing synthetic copies of the economy that researcherscould use to test policies and make forecasts.This approach, however, is not devoid of challenges. A faithful copy of the econ-omy requires getting a lot of details right. Synthetic agents should be initialized tomatch the real-world heterogeneity. Their behaviour should be truthful. Their inter-actions should be accurate.Unfortunately, it is not always possible to collect the data needed for this calibra-tion, and sometimes agents’ properties, behaviours, and interactions must be inferred.Part I of this thesis (Chapters 1, 2, 3, 4) focuses on inferring and modelling howfirms interact through production networks, i.e., networks of firms tied in commer-cial relationships. Networks [Barabasi, 2016, Newman, 2018] are a popular tool tomodel interplays between agents. Each agent is identified by a node in a networkand the presence of a link between two nodes signals an interaction. Network the-ory has been successfully applied to model a wide range of economic phenomena. In1Although these assumptions have been relaxed to build models with more realistic behaviours, theycan still be thought of as guiding principles of neoclassical economics.2To give an example, Nobel prize-winning, neoclassical models claim that an increase of 6°C inworld temperature would correspond to a drop of ∼ 10% in global GDP [Nordhaus, 2017]. The consen-sus among scientists is that a 6°C temperature rise would constitute an existential threat for hundredsof millions of people, force billions to migrate, and make densely populated regions more or less unin-habitable due to submersion, desertification, and exposure to extreme events [Stern, 2022].2finance, liabilities’ networks have been key to developing the notion of systemic risk[Haldane and May, 2011, Bardoscia et al., 2021]. In macroeconomics, production net-works [Carvalho, 2014, Carvalho and Tahbaz-Salehi, 2019] have been proposed as apossible cause for large macroeconomic fluctuations [Bak et al., 1993, Acemoglu et al.,2012, Moran and Bouchaud, 2019] and shown to be a key driver for shock propaga-tions [Leontief, 1936, Pichler et al., 2022, Carvalho et al., 2021, Diem et al., 2022]and economic growth [McNerney et al., 2022]. This literature suggests that a detailedknowledge of production networks is crucial to realistic macroeconomic modelling.Alas, data on production networks is very scarce; since these networks can’t bedirectly observed, we have to reconstruct them. In Chapter 1, we survey the recentliterature focussing on reconstructing production networks. In Chapter 2, we givean original contribution by reconstructing these networks using Machine Learning toreconstruct production networks. Using some sensible economic and financial prop-erties as inputs, we show that our algorithm outperforms some well-known bench-marks, investigate which features are important for accurate predictions, and study towhat extent our approach can be used in real-world tasks. Chapter 3 tackles the sameproblem from a different angle. We focus on firms’ sales time series and show thatthe production network has a visible impact on their correlation structure. We buildon this finding and develop a method to reconstruct production networks from firms’sales dynamics. Chapter 4 outlines an agent-based model designed to study the im-pact of exogenous shocks on the real production network. The primary agents of ourmodel are firms connected by trade and credit relationships. We explain the model,provide some analytical results, and describe a simple approach to generate weightedproduction networks that match some aggregate (and observable) properties of globaltrade.In the second part of the thesis (Chapters 5, 6), we pivot our focus away fromproduction networks and onto financial markets. Financial markets are arguably thebranch of economics where the application of complex systems theory is more estab-lished. In financial markets, millions of traders buy and sell assets agreeing, at anytime, on a price that satisfies both sides of the trade. The dynamics of these pricesare very diverse. Prices’ fluctuations are fat-tailed [Gopikrishnan et al., 1999, Malev-ergne et al., 2005, Gabaix, 2009] and intermittent [Mandelbrot, 1963], exhibit long-range correlations [Bouchaud et al., 2009], and are usually not related to external news[Cutler et al., 1988, Joulin et al., 2008, Marcaccioli et al., 2022]. This rich phenomenol-ogy and the profusion of financial data stimulated complex systems’ researchers, whohelped explain how traders’ orders affect prices [Bouchaud et al., 2018], the impact of3leverage [Thurner et al., 2012] and herding [Lux, 1995, Cont and Bouchaud, 2000] onmarket stability, and to draw analogies between markets and other dynamical systems[Sornette, 2006]. Another hybrid between complex systems theory and financial mar-kets is the Market Ecology Hypothesis. Market Ecology [Farmer, 2002, Lo, 2004, Hensand Schenk-Hoppe, 2009, Farmer and Skouras, 2013, Scholl et al., 2021] views themarket as an ecosystem of different trading strategies which evolve and specialize toexploit market inefficiencies. Investors allocate their funds based on strategies’ abilityto generate returns so that successful strategies become more popular while unsuc-cessful ones become extinct. In a simple model of the market, Scholl et al. [2021]drew a connection between the wealth allocation among three ‘macro’ classes of trad-ing strategies (value investors, trend followers, and noise traders) and market volatil-ity. In Chapter 5, we provide some empirical evidence for this phenomenon in realmarket data. Chapter 6 further explores the relationship between investors and mar-ket behaviour, focusing on the cryptocurrency market. Through a large dataset ofinvestments in cryptocurrency firms, we show that the returns of currencies shared bya single investor are statistically more correlated than the market average.Despite the diverse topics covered in this thesis, from production networks to fi-nancial markets, our overarching goal is to foster a more nuanced understanding ofeconomic phenomena. By leveraging machine learning, network theory, agent-basedmodels, and complex systems theory, we hope to contribute to a more realistic andcomprehensive modelling approach that is true to the composite nature of our globaleconomy.4Research contributionMost of the work presented in this thesis has been produced in collaboration withmentors and colleagues.Chapter 1 is based on Mungo et al. [2023], “Reconstructing supply networks”, co-authored with Alexandra Brintrup, Diego Garlaschelli, and François Lafond.Chapter 2 is based on Mungo et al. [2023], “Reconstructing production networksusing machine learning”, co-authored with my supervisors François Lafond and J.Doyne Farmer.Chapter 3 is based on Mungo and Moran [2023], “Revealing production networksfrom firm growth dynamics”, written together with José Moran.The work in Chapter 4 is a team effort with Anton Pichler, Andrea Bacilieri, andFrançois Lafond; Andrea has been involved in data processing and model calibration.Chapter 5 builds on previous work by Maarten Scholl, who also helped to assemblethe relevant data. The work has been supervised by J. Doyne Farmer.In Chapter 6, I enjoyed working with Laura Alessandretti and Silvia Bartolucci.The chapter is based on Mungo et al. [2023], “Cryptocurrency co-investment network:token returns reflect investment patters”.5Part IProduction Networks6When we think of semiconductors we typically envision smartphones, laptops, andhi-tech devices. However, semiconductors are embedded in a myriad of other objects:cars, dishwashers, and refrigerators alike. They are crucial components of our every-day life.Semiconductor production is a truly global enterprise, often involving designsfrom Europe or the United States, manufacturing in Taiwan, and assembly in China[Miller, 2022]. It is a complicated process, made possible by world-spanning, complexproduction networks.Disruptions of these networks have far-reaching consequences. Consider the re-cent pandemic. When COVID-19 spread across the world in 2020, the automotiveindustry cut its demand for chips, anticipating lower sales during lockdowns. At thesame time, the world prepared to work from home and demand for PC chips spiked.Throughout 2021, a series of accidents and lockdowns at crucial plants further shrunkthe production of microchips, so that when car manufacturers started to ask for morechips again, there were none left. They had to halt production, and automotive in-curred losses amounting to $200B [Miller, 2022].Semiconductors’ production networks also bear another risk: dependence on ahandful of firms. For instance, each year, 37% of the world’s microchips are pro-duced in Taiwan. The Taiwan Semiconductor Manufacturing Company (TSMC) aloneproduces 90% of the most advanced microchips globally. A rough estimate suggeststhat if TSMC was to shut down all its plants, the world would experience a downturncomparable to the Great Recession, affecting all the sectors of the economy-3The idea that the production of goods and services relies on a complicated networkof suppliers and customers has a long history in economics. As early as 1941, the No-bel Prize-winning economist Wassily Leontief wrote that everybody is ‘equally awareof the existence of some kind of interconnection between even the remotest parts ofa national economy [...] observed whenever expanded automobile sales in New YorkCity increase the demand for groceries in Detroit [...] when the sudden shutdownof the Pennsylvania coal mines paralyzes the textile mills in New England’ [Leontief,1941, Carvalho and Tahbaz-Salehi, 2019].4 To study this interconnection, Leontiefdeveloped its input-output framework [Leontief, 1986]. The input-output frameworkviews industries as nodes in a network of physical and monetary flows. Conservation3Ironically, several of these important companies are located in areas with a high seismic risk (Tai-wan, Japan, California).4Leontief must have also been aware of the risks lying in these interconnections, having designedeffective strategies to disrupt Germany’s economy during World War II [Bollard, 2019].7laws for these flows lead, at economic equilibrium, to linear systems of equations de-scribing the connections between industries’ outputs. The solutions of these equationsshow how changes in the production of a given industry affect the production of anyother economic sector. First used as a policy tool, the input-output framework waslater used to explain the origins of macroeconomic fluctuations.The existence of macroeconomic fluctuations is noteworthy in its own right. Thereare several sectors in the economy, each subject to idiosyncratic shocks. A diversifi-cation argument [Lucas, 1977] would suggest that, when taken together, these shockswould average out so that the aggregate output of an economy would be stable. Longand Plosser [1983] introduced a landmark neoclassical model showing that the link-ages between sectors could transmit shocks from one firm to another, placing produc-tion networks at the core of macroeconomic fluctuations. Further research [Acemogluet al., 2012, Carvalho et al., 2021, Diem et al., 2022] showed that the transmissionof economic shocks depends on the fine-grained structure of this network, and thatcoarse-grained analysis at the sectoral level can lead to a severe misestimation of riskand distress propagation. Furthermore, knowing production networks has proven im-portant for managing the green transition [Stangl et al., 2023], reducing tax evasion,and the enforcement of human rights and environmental standards. For many of to-day’s grand challenges, production networks matter.However, this is a disturbing remark: there are three hundred million firms world-wide [Pichler et al., 2023], and less than 1% of them are covered in the data [Bacilieriet al., 2023]. Recently, a stream of research has targeted the problem of reconstruct-ing this hidden network of firms. Given a set of firms, can we predict which of themare connected? In Chapter 1, we overview how researchers have tried to answer thisquestion. In Chapter 2 and Chapter 3, we provide two original contributions to theproblem. In Chapter 4, we outline a firm-level agent-based model to study the propa-gation of shocks across the supply chain. We also provide a method to assign a mon-etary value to the links in the production network, i.e., to reconstruct the networkweights.8Chapter 1Production Networks reconstructionIn mathematical terms, a network G is a tuple G = (V ,E) consisting of a set V =(1, . . . ,N ) of N = ∥V ∥ nodes and a set E ⊆ V × V of M = |E| links between pair ofnodes [Newman, 2018]. A network is weighted if, for every link (i, j) ∈ E, there existsa scalar ωij describing the strength of the connection. We say that a network is undi-rected if, for every link (i, j) ∈ E, it exists a link (j, i) ∈ E, and ωi,j = ωj,i ; the structureof a network can be encoded in an adjacency matrix Aij , such that Aij = 1 if (i, j) ∈ E,and Aij = 0 otherwise.Networks provide a unified formalism to describe systems that can be cast as a col-lection of interactive elements and have been successfully applied to study a variety ofcomplex systems, including biological (ecosystems and neural circuits), technological(power grids, telecommunications), and social systems.Knowing the topology of a network is important for (at least) two reasons. First,they can provide insights into the structure of the system. An emblematic exampleis the study by Milgram, which revealed that the average distance (i.e., number ofintermediate connections) between any two people in the U.S. social network is ap-proximately six. Second, when studying a dynamical process on a network, the topol-ogy is crucial to understanding the process’ evolution [Barrat et al., 2008].1 In manysituations, the topology of the network is either unknown or only partially known,compelling researchers to reconstruct the missing elements. The techniques constitut-ing the field of network reconstruction precisely aim at inferring the unknown portionof the network making use of the information available [Lü and Zhou, 2011, Squartiniet al., 2018, Cimini et al., 2021, Peel et al., 2022].Production networks, also known as “supply chains” or “supply networks”, consistof millions of firms producing and exchanging goods and services. From a mathemat-1However, the level of detail required to predict the dynamics accurately depends on the process,see, e.g., Prasse and Mieghem [2022].9ical perspective, they can be represented as weighted, directed networks, where nodessymbolize firms (or establishments), and links denote a supply-buy relationship withweights denoting transaction volume, such as the monetary value of the goods or ser-vices supplied over a given period.Supply networks share many properties with other economic networks, but alsoexhibit unique features. Some of their 
empirical properties include [Bacilieri et al.,2023]: “small-worldliness” (short average path lengths and high clustering), heavy-tailed degree distributions, heavy-tailed (link and/or node) weight distributions, strongcorrelations between node strength and degree, and similarly, between in- and out-degrees. It is also relatively well documented that, like biological and technologicalnetworks but unlike social networks derived from co-affiliation [Newman, 2002], sup-ply networks feature negative degree assortativity.However, supply networks are in many ways very different from other natural andeconomic networks. Their properties are deeply influenced by their function. First,the likelihood of a link between any two firms is driven by what the two firms areproducing: for instance, steel manufacturers buy more iron than sugar. Product qual-ity also plays a role, with “high quality” firms usually connecting with other “highquality” firms [Demir et al.]. Second, supply networks are strongly embedded in geo-graphic space, so that the likelihood of connections and their intensity decreases withdistance [Bernard et al., 2019]. Third, in contrast to, e.g., financial networks, supplynetworks are less constrained by strict external regulations, and emerge as the resultof a decentralized multi-criteria optimization process whereby millions of companiessimultaneously attempt to organise their production in a way that minimizes theircosts while maintaining acceptable levels of resilience to disruptions.These characteristics make production networks incredibly complex: in moderneconomies, a sophisticated product such as an aircraft might involve contracting thou-sands of firms and sourcing millions of parts that cross national borders multipletimes. Organizations in the network choose their dyadic relations and make local de-cisions, but hardly have visibility over their wider network. No single entity controls,designs and keeps track of the large-scale emergent network. As we mentioned inthe introduction to Part I, however, visibility over the network is increasingly impor-tant for several reasons: monitoring of environmental pledges to ensure firms quan-tify their greenhouse gas emissions, including those from their suppliers and cus-tomers; food and pharmaceutical traceability; analysing and improving supply chainresilience; and supply chain due diligence to ensure that actors that violate humanrights or engage in environmentally damaging actions are not present in the chain.10In the past decade, researchers in economics and complex systems have workedextensively to better understand supply chains. A key barrier to these studies has beena lack of data, as supply chains compete with one another [Christopher and Holweg,2011], making information on them highly commercially sensitive. As a result, moststudies to date have used firm-centred (e.g. starting with [Choi and Hong, 2002]) orsector-specific (e.g. global automotive [Brintrup et al., 2016] and aerospace [Brintrupet al., 2015], computer and electronics [Perera et al., 2017]) supply chains. Whilefirm-centric and industry-specific studies have been important in gathering insightsinto how network features shape the operation of supply chains, it remains hard togeneralize these findings.Due to the above challenges, production networks are a perfect use case for net-work reconstruction. Several recent studies have suggested the development of meth-ods to reconstruct or predict the existence of hidden links in supply chain networks,offering a variety of approaches. These range from the use of natural language pro-cessing to extract and infer data from the World Wide Web to probabilistic maximum-entropy methods, each with varying success rates.This chapter provides a brief survey of the literature focused on reconstructingproduction networks. We start by describing the key problems (Section 1.1): what datais available, what data is missing, and how to evaluate reconstruction performance. InSection 1.2, we overview the set of techniques generally employed in network recon-struction. We then summarise recent approaches to inferring the production networktopology (section 1.3), and to infer the values of transactions when the topology isknown (Section 1.4). We conclude with a discussion (section 1.5).1.1 The supply network reconstruction problemProduction networks can be modelled at different levels of detail, both for nodes andedges. Often, the properties of the network depend on its level of aggregation.At the most granular level, nodes would represent individual production plantswhere goods undergo processing and transformation. A more aggregate model wouldequate nodes with the companies operating these plants. One could further aggregateby either consolidating firms under a common parent company or grouping them byindustry sector.22One could think that the industry level is more aggregated than the firm. While this is mostly true,it is sometimes important to recognize that large firms span many industries. Industry-level input-output networks produced by national accounts arise from the Supply and Use Tables, which attemptto reallocate the output of multi-product firms into their appropriate categories.11Firms exchange various goods and services. In a very detailed approach, each prod-uct type could be identified with a specific type of edge, rendering the productionnetwork as an edge-labelled multigraph. A simpler model would connect two nodesif they are involved in any type of trade, irrespective of the products’ nature. Linkweights can also have different definitions, measuring either the flow of goods (interms, e.g., of the number of items traded) or the monetary value of such flow.In the context of this chapter, we define a supply network G as a graph wherenodes represent firms while directed, weighted links represent the value of the flowof goods and services in a buyer-customer relation. This definition proves practi-cal when reconstructing real-world supply networks from empirical data, which fre-quently adopts this format.1.1.1 What data is available?Almost all countries officially release Input-Output (I-O) tables, which provide theflow of money between industries, typically at the level of 50-500 industries. While wefocus on firms here, this data is sometimes useful in the methods below. Besides, I-Otables provide a meso-scale ground truth that could be a good target for reconstructionmethods.With this in mind, how do we expect the global firm-level supply network to looklike, and how much of it do we know?Pichler et al. recently produced an estimate of the size of the global firm-levelsupply network. They start from an estimate of about three hundred million firms inthe world, and for (domestic-only) supply networks where the full data is available,an average of about forty suppliers per firm. Thus, as a rough estimate, the full, globalfirm-level supply network could have 300 million nodes and 13 billion links.Bacilieri et al. provides a taxonomy of existing datasets covering this network;these are mainly commercial datasets confidential datasets held by governments, pay-ment data, and industry-specific datasets.Purchasing data from data providers, such as FactSet, Capital IQ, or Bloomberg isrelatively straightforward, but commercial datasets can be very expensive, and coveronly a fraction of firms, a very small fraction of links, and usually do not include thevalue of the transactions. As commercial data providers typically assemble their datafrom publicly available information, researchers may also decide to collect this infor-mation themselves. An example is the extraction of data from the World Wide Web,after which machine learning algorithms are trained to predict supply-buy relation-ships [Wichmann et al., 2020]. Such an approach enables researchers to successfully12gather rudimentary maps of supply chains, although it is limited to publicly availabledata, hence necessitating reconstruction efforts to identify missing relationships.The option of using government-held data necessitates datasets to be shared bynational authorities, which may not always be feasible. However, where data has beencollected by a national authority it is usually of very high quality. For example, VATreporting may contain the value of transactions and timestamped data between vir-tually all firms within a country. Bacilieri et al. shows that VAT datasets with noreporting thresholds exhibit strikingly similar properties, while incomplete datasets(either because of a reporting threshold or because they are assembled from publiclyavailable information) usually have fewer links so that many key statistics are likelyto be highly biased.A third option is payment data, which is usually (but not always) limited to indi-vidual banks collecting payment flow data between their client firm (see, e.g., Ialongoet al.). Although it is not guaranteed that every transaction corresponds to a businesslink within a supply network, it can be viewed as a plausible indicator. These datasetsare extremely detailed for any subset of firms affiliated with the same bank. However,they do not cover firms served by different banks or accounts held by their clients indifferent institutions.Finally, datasets focusing on specific industry verticals are also sometimes gath-ered by private companies (e.g., MarkLines’ automotive dataset used in Brintrup et al.[2018])) and public regulatory bodies (e.g., the U.S. Drug Enforcement Administra-tion’s dataset of controlled substances flow). However, they are usually limited tospecific geographies and production sectors.There are no large-scale publicly available datasets on firm-level production net-works, making it impossible at the moment to portray the global supply network.Summing up the number of nodes in the datasets reported in Bacilieri et al. [2023]gives roughly three million, less than 1% of the 300m nodes reported earlier. Merg-ing all the available datasets would give only an even smaller portion of the links andweights. This limitation forces researchers to use alternative options to proxy supplynetworks from smaller-scale, more specific datasets. These methodologies, developedto reconstruct or infer missing information about supply networks, are the main focusof this chapter.However, what ‘reconstructing’ actually means depends on the data already avail-able to the researchers and the ultimate use of the (inferred) data, i.e. the goal of theanalysis. We discuss these points in what follows.131.1.2 A taxonomy of supply network reconstruction approachesWe classify the studies we review along four primary axes. We do not see these clas-sifications as having rigid boundaries, but rather as providing continuous dimensionswhere models can be placed variably.Predicting network topology and/or weights on transactions. Consider a matrixΩ where Ωij shows the amount paid by j to i. We distinguish between methodsthat focus only on finding the network’s topology, i.e., the presence or absence of acommercial connection between two firms encoded in the (binary) adjacency matrixAij = 1↔Ωij > 0, and those that assume that the adjacency matrix is known and tryto infer the monetary value of the existing connections, i.e. the link weights Ωij |Aij = 1(see also point c below). Note that some methods try to simultaneously reconstructboth the topology and the weights of the network. Most of the methods we reviewfocus on network topology.Predicting individual links or the full network. Some methods focus on identify-ing the presence of specific links independently, while others try to reconstruct theentire network at once. The difference is subtle, yet important.Typically, links in production networks are not independent. For instance, if firmstend to not “multi-source”, so if they are connected to supplier j for a key input, theyare less likely to be connected to other suppliers for that input.The methods focusing on identifying the presence of each link independently areusually known as link prediction, while we refer to the second approach as networkinference. In general, network inference computes the full distribution P (G) over theset of possible networks. Link prediction, instead, computes the marginal probabilitypij of an edge between nodes i and j.3 Again, there is no hard boundary between thetwo methods, which are occasionally equivalent. If one takes links independence as amodelling assumption, computing the values pij and reconstructing the network areeffectively equivalent, as the probability P (G) factorizes asP (G) =∏(i,j)∈E(G)pij∏(i,j)<E(G)(1− pij), (1.1)where E(G) denotes the set of edges realized in graph G. Even if link independenceis not directly assumed, some network inference methods can produce probability3More generally, link prediction methods produce a score sij , such that sij > skl =⇒ pij > pkl . How-ever, such scores are not necessarily smaller than one, and the ratio between two scores is not necessarilyequal to the ratio between links probabilities.14distributions P (G) that factorize as in Eq. (1.1) (see, e.g., Ialongo et al.). Finally, when-ever the full probability P (G) is available, it is possible to compute the values pij aspij = P(Aij = 1)=∑G∈G P (G)Aij , and use them in a link prediction exercise.It is fair to say that link prediction is typically a less refined approach, as we knowthat the factorization in Eq. (1.1) is, at most, only approximately true in reality. How-ever, link prediction methods can still capture meso- and macro-scale features of thenetwork and, by framing the reconstruction problem as a binary classification task,link prediction facilitates easy comparison of methods through standard performancemetrics.Using topological information or not. Of course, all reconstruction methods needthe network to test their predictions. However, while some methods need the ad-jacency matrix to be trained, other methods can learn from node-level or pair-levelfeatures only. This is important because the methods that do not rely on the adjacencymatrix for training can be used in contexts where the detailed network is not observed,as long as the node-level and pair-level features are available.Probabilistic or deterministic. Some models produce deterministic outputs, usuallyfinding a network configuration by minimizing or maximizing a given loss function.Consequently, their output is a single network realization that is, in some sense, op-timal. Other methods provide probabilities over possible network realizations . Thegoal of these methods can then be viewed as finding a ‘good’ probability distribution,peaked ‘around’ or ‘close’ to the true one. Equipped with this probability distribu-tion, researchers can find the typical and most likely realizations of the network andcompute, for instance, expected values and confidence intervals for properties of thenetwork.1.1.3 Evaluating the reconstructed networksIn their review paper on network reconstruction, Squartini et al. provide a usefultaxonomy of performance metrics: statistical, topological, and dynamical indicators.Statistical indicators evaluate the quality of the reconstructed network on a link-by-link (or weight-by-weight) basis. Different statistical indicators apply to deterministicand probabilistic outcomes.In the realm of deterministic outcomes, perhaps the most commonly employedindicator is accuracy (or precision, the proportion of correct predictions. In supply15networks, however, there is a strong class imbalance: the number of pairs not linkedis much higher than the number of pairs linked. Thus, it is generally easy to make“correct” predictions since predicting that a link does not exist is very likely to be cor-rect. For this reason, a commonly used metric is the F1-score, defined as the harmonicmean of precision and recall (how many relevant items are selected), which offers amore balanced performance metric in unbalanced datasets.For probabilistic reconstructions, the evaluation is often based on the area underthe receiver operating characteristic curve (AUROC) and the area under the precision-recallcurve. AUROC, derived from the Receiver Operating Characteristic (ROC) curve, es-sentially quantifies models’ ability to discern between classes at varying thresholdlevels. The ROC curve plots the true positive rate (recall) 
against the false positiverate for different decision thresholds (i.e., by considering “true” all the predictionswith probability larger than a certain threshold τ , for different values of τ), givinginsights into the trade-off between sensitivity (true positive rate) and specificity (truenegative rate). The AUROC, being the area under this curve, ranges from 0.5 to 1, with1 implying an ideal classifier and 0.5 suggesting no better than random guessing. SeeSec. 2.2.2 for a longer description of ROC curves.While statistical indicators focus on individual links, they may not adequatelyevaluate if the reconstructed network replicates complex network structures. Topolog-ical indicators measure how well the network’s macro-level and meso-level featuresare reproduced. Topological indicators gauge how effectively the reconstruction cap-tures the network’s ‘coarse-grained’ features. For instance, Ialongo et al., validate theirreconstruction methodology by assessing how accurately it replicates the network’sdegree distribution.Topological indicators can tell us whether the reconstructed and true networks are“similar”. However, ultimately the key question is whether a reconstructed network isgood enough to give good answers to substantive economic questions. Dynamical (ormore generally model-based) indicators assess the similarity in the process’ evolutionon the real and reconstructed networks. As an example, Diem et al. introduced theEconomic Systemic Risk Index (ESRI) to quantify each firm’s importance within an econ-omy. The metric measures the percentage drop in the economy’s overall productioncaused by the removal of a firm from the network. Its computation requires running adynamical process, wherein the sudden disappearance of a firm first impacts its sup-pliers and customers and, iteratively, spreads to firms that are further in the network,until the system reaches an equilibrium. Conceivably, accurately estimating firms’16ESRI may only necessitate identifying a subset of key links serving as primary con-tagion channels, implying that the majority of links and the network’s higher-orderfeatures may have less bearing on the results.1.2 Network reconstruction techniquesNetwork reconstruction is a multidisciplinary pursuit, with various methodologiesdeveloped across natural and social sciences. As we saw, there are two common ap-proaches to the network reconstruction problem: link prediction, where each link inthe network is predicted independently, and network inference, where the whole net-work is inferred at once. In the previous section, we explained that there is not a“hard” boundary between the two methods. However, they are a useful classificationscheme to organize the techniques that we are going to review.1.2.1 Link PredictionLink prediction involves assigning a score to each possible link, assuming that suchscore proxies the probability that the link exists. We can calculate these scores basedon the network’s structure (assuming we know at least part of the network), nodes’and links’ attributes, or both.Scores derived from the network’s structure are known as structural similarity scores.In their 2011 review, Lü and Zhou delineated the most common structural similarityscores used in link prediction, dividing them into local, quasi-local, and global scores.To compute local similarity scores for the link (i, j), we only need to know the neigh-bours of two nodes A and B (see Tab. A.1, Appendix A.1). To compute quasi-localsimilarity scores, we need to know neighbours at a network distance greater than one.Finally, global similarity scores require knowledge of the entire network.4The design of such local, quasi-local, and global structural similarity scores wasoriginally performed manually, based on researchers’ intuition and domain expertise.More recently, Graph Neural Networks (GNN) [Bronstein et al., 2017, Hamilton, 2020],a class of neural network models specifically engineered for dealing with graph data,have been used to leverage the network structure without the need for explicitly de-signing any scoring algorithm [Zhang, 2022]. GNN-based link prediction primarilyfollows two paradigms: node-based and subgraph-based. The node-based approach4For ‘the entire network’ we mean the whole observed network. These methods are used to identifyexisting but unobserved links in a network or to predict the appearance of these links in the future butare not suited to reconstruct a network ‘from scratch’ when no link is observed.17first learns a node representation through a GNN, then aggregates pairwise node rep-resentations into link representations for prediction. Subgraph-based methods firstextract a local subgraph around each target link, then apply a graph-level GNN toeach subgraph, learning a subgraph representation, which is used as the target linkrepresentation for prediction.Structural similarity scores have been collectively used as predictors in a moretraditional supervised-learning setting [Ghasemian et al., 2020].Other approaches to link prediction that do not require explicit modelling of ascore are those based on network embedding. Network embedding [Cui et al., 2019]methods learn low-dimensional representations (i.e., embeddings) for nodes. Theseembeddings aim to preserve the structure of the network by positioning connectednodes close to one another in the latent space. The distance of nodes in the latent spacecan then be used as a score for link prediction. A famous example is the Node2Vec[Grover and Leskovec, 2016] algorithm.However, all structural scores face the cold start problem. When a new node joinsthe network, these methods may struggle to predict its links accurately due to the lackor the limited number of existing links with other nodes. The problem is exacerbatedwhen we can only observe a set of nodes, but we can’t observe any link in the network.Content-Based methods [Zhang, 2022] can be helpful in these situations. Content-basedmethods leverage explicit nodes’ features for link prediction. As we will see in Chap-ter 2, these methods have been successfully applied to predict links in productionnetworks.51.2.2 Network inferenceA second set of approaches tries to reconstruct the entire network at once. Broadlyspeaking, these approaches either compute a probability distribution over the set ofpossible networks or produce a network that is optimal in some sense. A completesurvey of these methods is beyond the scope of this section, where we will only reviewa few that are relevant for production networks.A first approach is rooted in statistical physics and based on the maximum-entropyprinciple [Jaynes, 1957, 1982, Cover and Thomas, 2005]. In maximum-entropy mod-els, also known as Exponential Random Graph models, the probability of a graph G,5Structural and content-based methods can be combined. Graph Neural Networks are, for example,able to ingest both topological information and nodes’ covariates.18P (G), is obtained by maximizing the Shannon entropy S ,P (G) = maxPS (P ) = maxP−∑G∈GP (G) lnP (G).The maximization is subject to a normalization constraint,∑G∈G P (G) = 1, and a col-lection of m constraints c∗ representing the macroscopic properties enforced on thesystem. These constraints are usually enforced in a soft way, that is, by constrainingthe expected values of the constraints over the set of possible networks,∑G∈GP (G)ci (G) = c∗i .Introducing the set of Lagrange multipliers θ in the maximization procedure we get,P (G) = maxPS −θ0∑G∈GP (G)− 1− m∑i=1θi∑G∈GP (G)c (G)− c∗i ,which leads to the probability distributionP (G|θ) = e−H(G,θ)Z (θ),where the function H (G,θ) = θ · c∗ is known as the Hamiltonian, the function Z (θ) isthe partition function, and the values θ are chosen to satisfy ci (G) = c∗i∀i. The intuitionbehind the procedure is to compute a probability distribution that is maximally non-committal with respect to unknown information Jaynes [1957] or, in simpler words,to build a probability distribution that minimizes unjustified assumptions about thenetwork.The model accepts an analytical solution when the constraints are the density ofthe network, a degree sequence {ki}, and a sequence of in- and out-degrees{sini , souti}.Researchers have widely employed these methods to reconstruct financial and tradenetworks [Squartini et al., 2018, Cimini et al., 2019], and, more recently, to recon-struct production networks [Ialongo et al., Bacilieri and Astudillo-Estevez, 2023].A second approach is matrix completion. The key assumption in matrix completion[Nguyen et al., 2019] is that the underlying true matrix has a low-rank structure. Amatrix is said to be of rank-r if it can be expressed as the product of two matrices, onehaving r columns and the other r rows.6Matrix completion factorizes the observedadjacency matrix A of the network into the product of a low-rank embedding matrix6If a matrix has a low rank, its rows (or columns) are highly correlated.19Z and its transpose. It approximately reconstructs an edge between two nodes i and jusing their embeddings zi and zj ,Âi,j = zTi zj ,where the embedding matrix Z minimizes a loss L,L = 1|E|∑(i,j)∈E(Ai,j − Âi,j)2.Matrix completion has been employed to reconstruct aggregate Input-Output tables[Metulini et al., 2022] but, so far, has not been employed for firm-level productionnetworks. A last set of approaches has been developed to reconstruct networks thatsupport a statistical or physical process [Dong et al., 2019, Peel et al., 2022]. Thesituation is the following. Imagine a network G composed of N nodes, and a processtaking place on the network. Here, we use the term process very broadly. For instance,drawing T samples from a multivariate probability distribution of N variables couldrepresent a statistical process, while an example of a physical process could be thespread of a disease among a network of N people over T days. We can observe theevolution of the process by tracking the state of each node through time, xi (t). Weknow that the evolution of the process is influenced by the graph G; the goal is thento reconstruct the graph from the observations xi .The philosophy behind the statistical view is that there exists a graph G, whosetopology determines the joint probability distribution of the observations xi on thenodes. These models are known as probabilistic graphical models [Koller and Friedman,2009], where the edges in the graph encode the conditional dependence relationshipamong random variables that are represented by the vertices. To provide some intu-ition on how these models work, we will review a well-known reconstruction methodin the probabilistic graphical model framework: the graphical Lasso. For a more de-tailed review of probabilistic graphical models, we refer to the survey by Dong et al..There are two main types of graphical models: undirected graphical models, alsoknown as Markov random fields (MRFs), in which local neighbourhoods of the graphcapture the independence structure of the variables, and directed graphical models,also known as Bayseian networks or belief betworks, which have a more complicatednotion of independence by taking into account the direction of the edges [Dong et al.,2019]. An MRF with respect to a graph G = {V ,E} is a set of random variables x ={xi : i ∈ V } that satisfy the pairwise Markov property(i, j) < E⇔ P(xi |xj ,x\\{xi ,xj})= P(xi |x\\{xi ,xj}).20In other words, the two random variables xi and xj are conditionally independentgiven the rest if there is no edge between the corresponding vertices i and j. A well-known example of MRFs is Gaussian MRFs. In Gaussian MRFs, the probability ofdrawing a set of random variables X, Xi,t = xi (t) is given by a multivariate Gaussiandistribution,P (X |Θ) = |Θ|12(2π)N2exp(−12XTΘX),where Θ is the inverse covariance or precision matrix. In this context, learning thegraph structure boils down to learning the matrix Θ, which encodes pairwise condi-tional independence between the variables: a null entry Θij means that there is no linkbetween nodes i and j.Assume that the variables xi have zero mean and unit standard deviation. UsingBayes’ theorem, we can write the probability p (Θ|X) asP (Θ|X) = P (X |Θ) P (Θ)P (X).Assuming a uniform prior for the matrix Θ and ignoring the factor p (X) (which doesnot depend on Θ), we find that p (Θ|X) ∝ P (X |Θ). Since XTΘX = tr(XTXΘ)= tr(CΘ),where C is the empirical correlation matrix Cij = xTi · xj and tr(·) is the trace of thematrix, the function logp (X |Θ) islogP (X |Θ) = −N2log(2π) +12logdetΘ − 12tr(CΘ) .The graphical Lasso method [Banerjee et al., 2008] proposes to find the matrix Θ thatmaximizesmaxΘlogdetΘ − tr (CΘ)− ρ∥Θ∥.Essentially, the method prescribes to maximize the log-likelihood under a GMRF (i.e.,the function logp (X |Θ) ), with a penalty term added to enforce sparsity of the con-nections with a regularization parameter ρ. The method estimates the entire precisionmatrix Θ simultaneously, consequently providing a reconstruction of the full network.In Chapter 3 we will use graphical Lasso to reconstruct the production network.Finally, in physically motivated models the observations X are considered the out-come of some physical phenomena on the graph [Peel et al., 2022]. Peixoto [2019]provides an example. In a nutshell, the approach consists of 1) assuming a generativemodel for a network7 defined by a set of parameters b, P (G|b); 2) assuming an appro-priate model for the evolution of the system given an underlying network G, P (X |A);7In the specific example of the paper, the generative model is a stochastic block model.213) using Bayes’ theorem to compute P (G,b|X) asP (G,b|X) = P (X |G)P (G|b)P (b)P (X);4) sampling the above distribution using a Markov Chain Monte Carlo procedure.The above process has the double advantage of simultaneously providing a distribu-tion for the networkG and the parameters b of its generative model. In Peixoto [2019],the author simulates an epidemic process (SIS model) and an Ising model on severalsynthetic and real-world networks and uses the method to reconstruct the networksand infer their community structure. An overview of the paper, together with sev-eral other physical-based approaches to network reconstruction, can be found in thereview by Peel et al..In this section, we surveyed several approaches developed to reconstruct networks.While not exhaustive, we hope that our review provides an intuition on how some ofthe most well-known methods work and some useful references to help the readerdelve deeper into the subject. In the following section, we review how these ap-proaches have been used to reconstruct production networks.1.3 Reconstructing the production network topologyWe start by reviewing studies that focus on predicting the binary adjacency matrix, us-ing either link prediction or network inference methods. Table 1.1 provides an overallsummary of the methods and their differences.1.3.1 Link prediction1.3.1.1 Setting up the problemAn early stream of research employs machine learning for link prediction in produc-tion networks. The key idea is to construct a dataset in the form of Fig. 1.1A, wherefor each pair (i, j), we collect some features f(i,j) that can be features of each node (e.g.,the product it makes, its total sales, etc.) or of the pair (e.g. geographical distance,whether they have a common supplier or client, etc.), and the response Aij , which isequal to 0 or 1.With such a dataset, one can then train a machine-learning classifier on a set ofexamples{f(i,j),Aij}. Different papers have then made different choices for the pre-dictors f(i,j) and the predictive algorithm, as we will discuss in detail. But before, letus note another critical element, which is the construction of the dataset. Production22(a)Undersampling(b)Figure 1.1: (a) Datasets for link prediction are usually built by filling rows with twonodes features (fu , fv , fu,v) and by indicating if there is a link between the two nodes(Au,v). (b) These datasets are usually undersampled: in the original dataset, a smallminority of the rows will be s.t. Au,v = 1 (blue), while most of the rows will be s.t.Au,v = 0 (red); undersampling discards a portion of them to generate a more balanceddataset.networks are very sparse [Bacilieri et al., 2023], so the ratio betwe